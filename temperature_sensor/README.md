# Проект датчика температуры для K1921VG015

## Описание
Этот проект демонстрирует работу с встроенным датчиком температуры микроконтроллера K1921VG015. Проект использует ADC для измерения температуры и выводит результаты через UART.

## Функциональность
- Инициализация и настройка встроенного датчика температуры
- Периодическое измерение температуры (каждую секунду)
- Вывод результатов измерения через UART
- Индикация работы с помощью светодиодов
- Конвертация ADC значений в температуру в градусах Цельсия

## Структура проекта
```
temperature_sensor/
├── main.c                    # Основной файл с кодом
├── makefile                  # Файл сборки
├── niiet_aspect.json        # Конфигурация проекта
├── README.md                # Документация
├── device/                  # Файлы устройства
│   ├── Include/            # Заголовочные файлы
│   ├── Source/             # Исходные файлы
│   ├── ldscripts/          # Скрипты линковщика
│   └── config.json         # Конфигурация устройства
└── plib/                   # Библиотеки периферии
    └── inc/                # Заголовочные файлы библиотек
```

## Используемые периферийные модули
- **TSENS** - встроенный датчик температуры
- **ADCSAR** - аналого-цифровой преобразователь
- **TMR32** - 32-битный таймер для периодических измерений
- **GPIOA** - порт ввода-вывода для светодиодов
- **UART** - для вывода результатов

## Настройка и сборка

### Требования
- Компилятор RISC-V GCC
- Make
- Отладочный адаптер (опционально)

### Сборка проекта
```bash
# Перейти в папку проекта
cd temperature_sensor

# Собрать проект
make all
```

### Очистка
```bash
make clean
```

### Отладка
```bash
make debug
```

### Ручная компиляция (если make не работает)
```bash
# Компиляция с указанием путей к заголовочным файлам
gcc -I./device/Include -I./plib/inc -c main.c -o main.o

# Линковка (требует настройки путей к библиотекам)
gcc main.o -o temperature_sensor.elf
```

## Принцип работы

1. **Инициализация**: Настраиваются все необходимые периферийные модули
2. **Запуск измерения**: Запускается первое измерение температуры
3. **Периодические измерения**: Каждую секунду запускается новое измерение
4. **Обработка результатов**: ADC значения конвертируются в температуру
5. **Вывод данных**: Результаты выводятся через UART

## Калибровка
Для точного измерения температуры необходимо выполнить калибровку:
- Константы `TEMP_OFFSET` и `TEMP_SLOPE` в файле `main.c` являются примерными
- Для точной калибровки необходимо измерить температуру при известных условиях
- Рекомендуется использовать эталонный термометр для калибровки

## Вывод данных
Программа выводит следующую информацию:
- Частота системной шины
- Уникальный идентификатор микроконтроллера
- Номер измерения, ADC значение и температура в °C

Пример вывода:
```
K1921VG015 SYSCLK = 160 MHz
  UID[0] = 0x12345678  UID[1] = 0x9ABCDEF0  UID[2] = 0x11111111  UID[3] = 0x22222222
  Инициализация датчика температуры
Измерение #1: ADC = 0x1F8, Температура = 25.00°C
Измерение #2: ADC = 0x1FA, Температура = 25.13°C
...
```

## Автор
НИИЭТ, Александр Дыхно <dykhno@niiet.ru>

## Лицензия
Данное программное обеспечение предоставляется «как есть», без каких-либо гарантий.
